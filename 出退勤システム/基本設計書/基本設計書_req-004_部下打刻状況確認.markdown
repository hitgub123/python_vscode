# 基本設計書

## 1. ドキュメント概要
本基本設計書は、出退勤システムの要件に基づき、部下打刻状況確認機能の基本設計を定義するものである。日本IT業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## 2. システム概要
本システムは、管理職が自身の部下の出退勤状況および過去の打刻履歴をリアルタイムで確認するための機能を備えた出退勤システムである。主な機能として、ウェブインターフェースまたは管理用アプリを用いた状況確認機能を提供し、管理職が利用することを想定している。

## 3. 要件定義
### 3.1 要件一覧
| ID       | 分類             | 要件名             | 概要                                                                 | 利用者       |
|----------|------------------|--------------------|----------------------------------------------------------------------|--------------|
| req-004  | 出退勤記録管理   | 部下打刻状況確認   | 管理職は、自身の部下の現在の出退勤状況および過去の打刻履歴をリアルタイムで確認できる。 | 管理職       |

## 4. 機能設計
### 4.1 部下打刻状況確認機能 (req-004)
#### 4.1.1 機能概要
管理職がウェブインターフェースまたは管理用アプリを通じて、自身の部下の現在の出退勤状況および過去の打刻履歴を確認する機能を提供する。リアルタイム表示および検索機能により、迅速な状況把握を支援する。

#### 4.1.2 入力仕様
- **検索条件**
  - 対象従業員：部下の従業員IDまたは名前（複数選択可）
  - 期間：開始日および終了日（デフォルト：当日または過去1ヶ月）
  - 打刻種別：出社/退社/休憩開始/休憩終了（複数選択可）
- **認証**
  - 管理職認証（ログインID、パスワード、または生体認証）が必要。
  - アクセス権限：管理職は自身が管理する部下のデータのみ閲覧可能。

#### 4.1.3 出力仕様
- **表示内容**
  - 従業員情報：従業員ID、名前
  - 現在の状況：出勤中/退勤済/休憩中/未出勤
  - 打刻履歴：打刻日時、打刻種別、デバイス種別、位置情報（設定に応じて）
- **表示形式**
  - ダッシュボード形式（リアルタイム状況）
  - リスト形式（履歴、期間指定）
  - オプション：CSVまたはPDFエクスポート機能
- **通知**
  - 異常検知時（例：打刻忘れ）アラート表示

#### 4.1.4 処理フロー
1. 管理職がアプリまたはウェブインターフェースで状況確認画面にアクセス。
2. システムが管理職の認証およびアクセス権限を確認。
3. 管理職が検索条件（対象従業員、期間など）を入力。
4. システムがデータベースから該当するデータを取得。
5. 検索結果またはリアルタイム状況を管理職に表示。

#### 4.1.5 エラー処理
- **認証失敗**：エラーメッセージを表示（例：「ログイン情報が正しくありません」）。
- **権限エラー**：エラーメッセージを表示（例：「閲覧権限がありません」）。
- **通信エラー**：エラーメッセージを表示し、再試行を促す。

## 5. データ設計
### 5.1 データベース構造
#### 5.1.1 打刻履歴テーブル (T_ATTENDANCE_LOG)
| 項目名            | データ型       | 説明                              | 主キー |
|-------------------|----------------|-----------------------------------|--------|
| log_id            | BIGINT         | 打刻ログID（自動採番）           | ○      |
| employee_id        | VARCHAR(10)    | 従業員ID                         |        |
| timestamp         | DATETIME       | 打刻時刻（JST）                  |        |
| attendance_type   | VARCHAR(2)     | 打刻種別（出社:01/退社:02/休憩開始:03/休憩終了:04） |        |
| device_type       | VARCHAR(2)     | デバイス種別（IC:01/アプリ:02/ウェブ:03） |        |
| location          | VARCHAR(100)   | 位置情報（GPS座標、任意）        |        |

#### 5.1.2 従業員管理テーブル (T_EMPLOYEE_MGMT)
| 項目名            | データ型       | 説明                              | 主キー |
|-------------------|----------------|-----------------------------------|--------|
| employee_id        | VARCHAR(10)    | 従業員ID                         | ○      |
| manager_id        | VARCHAR(10)    | 管理職ID                         |        |

## 6. インターフェース設計
### 6.1 外部インターフェース
- **管理用アプリ**
  - OS：iOS 15以上、Android 10以上
  - API：RESTful API（JSON形式）
  - 認証：JWTトークンまたは生体認証
- **ウェブインターフェース**
  - 対応ブラウザ：Chrome、Firefox、Safari（最新バージョン）
  - API：RESTful API（JSON形式）
  - 認証：JWTトークン

### 6.2 内部インターフェース
- **サーバー間通信**
  - プロトコル：HTTPS
  - データ形式：JSON
  - エンドポイント例：
    - GET /api/attendance/subordinate-status（部下状況取得）
    - GET /api/attendance/subordinate-history（部下履歴取得）

## 7. 非機能要件
### 7.1 性能
- 状況確認処理：2秒以内に完了
- 同時検索：最大50人/分

### 7.2 可用性
- 稼働率：99.9%
- メンテナンス時間：毎月第2日曜 0:00-3:00

### 7.3 セキュリティ
- データ暗号化：TLS 1.3
- 認証：多要素認証（アプリおよびウェブ）
- アクセス制限：管理職は自身が管理する部下のデータのみ閲覧可能

## 8. テスト計画
### 8.1 単体テスト
- 各コンポーネント（認証、権限確認、状況取得、履歴取得）の動作確認。
### 8.2 結合テスト
- アプリおよびウェブからの状況確認が正しく表示されることを確認。
### 8.3 負荷テスト
- 50人同時検索時のレスポンスタイムを測定。

## 9. 運用・保守
### 9.1 運用体制
- サポート窓口：平日9:00-17:00
- 障害対応：24時間365日（緊急時）
### 9.2 保守内容
- 月次パッチ適用
- 年次システムアップデート

## 10. 付録
### 10.1 用語集
- 打刻：出社、退社、休憩開始、休憩終了の時刻を記録する行為
- 管理職：部下の出退勤状況を管理する権限を持つ従業員
- アプリ：出退勤管理用スマートフォンアプリケーション
- ウェブインターフェース：ブラウザ経由でアクセスする管理ページ

### 10.2 参考資料
- 日本IT業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025年6月版）