# 基本設計書

## ドキュメント概要
本基本設計書は、出退勤システムの要件に基づき、システムの基本設計を定義するものである。日本IT業界の標準的な規範に従い、明確かつ構造化された記述を行う。

| ID | 作成者 | 作成日付 |
|---|---|---|
| req-012 | カエルXX | 2024-05-24 |

## システム概要
本システムは、従業員の勤怠を管理するシステムの一部として、残業の申請機能を提供する。従業員は本機能を利用し、事前に残業の承認を求めることができる。

## 要件定義
### 要件一覧
| ID | 分類 | 要件名 | 概要 | 利用者 |
|---|---|---|---|---|
| req-012 | 残業管理 | 残業申請 | 従業員は、予定される残業時間および理由を記載し、事前に残業の申請を行うことができる。 | 一般従業員 |

## 機能設計
### 残業申請機能 (req-012)
#### 機能概要
一般従業員が、Webアプリケーションまたはスマートフォンアプリを通じて、残業を行う前にその予定時間と業務理由を申請する機能を提供する。

#### 入力仕様
- **対象日**: 残業を行う日付 (YYYY-MM-DD)
- **予定時間**: 予定開始時刻(HH:MM) ～ 予定終了時刻(HH:MM)
- **申請理由**: 残業を行う具体的な理由（テキスト入力、必須）

#### 出力仕様
- 申請完了後、画面に「残業申請を受け付けました。」等の完了メッセージを表示する。
- 申請内容は、承認者（管理職）へ通知される。

#### 処理フロー
1. 従業員がシステムにログインし、残業申請画面を開く。
2. 対象日、予定時間、理由を入力し、「申請」ボタンを押下する。
3. システムが入力内容の妥当性チェック（必須項目の入力有無、時間の前後関係など）を行う。
4. チェックOKの場合、残業申請テーブルに「申請中」ステータスでデータを保存する。
5. ワークフローに基づき承認者へ通知を送信し、申請者の画面に完了メッセージを表示する。

#### エラー処理
- **入力不備**: 必須項目が未入力の場合や、時間の形式が不正な場合、エラーメッセージを表示し再入力を促す。
- **業務ルール違反**: <font color="red">会社の規定する月間残業時間の上限を超える申請が行われた場合、「月間の上限時間を超えるため申請できません。」等のエラーメッセージを表示し、処理を中断する。</font>

## データ設計
### データベース構造
#### 【新規】残業申請テーブル (T_OVERTIME_APPLICATION)
| 項目名 | データ型 | 説明 | 主キー |
|---|---|---|---|
| application_id | BIGINT | 申請ID（自動採番） | ○ |
| employee_id | VARCHAR(10) | 申請者の従業員ID | |
| work_date | DATE | 残業対象日 | |
| planned_start_time | TIME | 予定開始時刻 | |
| planned_end_time | TIME | 予定終了時刻 | |
| reason | VARCHAR(255) | 申請理由 | |
| status | VARCHAR(2) | ステータス（01:申請中, 02:承認, 03:却下, 04:取下） | |
| application_timestamp | DATETIME | 申請日時 | |

## インターフェース設計
### 内部インターフェース
- **APIエンドポイント例**:
  - `POST /api/overtime/applications` (残業申請データ登録)

## 非機能要件
### 性能
- 残業申請の登録処理は、3秒以内に完了すること。

## テスト計画
### 単体テスト
- 残業申請画面の入力バリデーションが正しく機能することを確認する。
- 申請データが残業申請テーブルに正しく保存されることを確認する。

## 付録
### 用語集
- **残業申請**: 所定労働時間を超えて勤務を行うことについて、事前に承認を得るための手続き。
