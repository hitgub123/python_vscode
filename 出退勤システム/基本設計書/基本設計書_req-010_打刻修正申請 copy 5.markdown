# 基本設計書

## ドキュメント概要
本基本設計書は、出退勤システムの要件に基づき、システムの基本設計を定義するものである。日本IT業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要
本システムは、従業員の勤怠状況や休暇を管理するシステムである。本設計書では、一般従業員による自身の休暇残日数の確認機能について定義する。

## 要件定義
### 要件一覧
| ID | 分類 | 要件名 | 概要 | 利用者 |
|---|---|---|---|---|
| req-009 | 休暇管理 | 休暇残日数確認 | 従業員は、自身の休暇（有給など）の残日数を確認できる。 | 一般従業員 |

## 機能設計
### 休暇残日数確認機能 (req-009)
#### 機能概要
一般従業員が、Webアプリケーションまたはスマートフォンアプリのダッシュボードや専用画面から、自身の年次有給休暇などの残日数、および取得履歴を確認できる機能を提供する。

#### 入力仕様
- 本機能は情報を表示する機能であるため、利用者による直接的な入力操作はない。画面表示の要求が入力となる。

#### 出力仕様
- **画面表示**
  - **現在の残日数**: 例「12.5日」
  - **内訳情報**:
    - 前年度繰越日数
    - 本年度付与日数
    - 本年度取得済み日数
  - **有効期限**: 次に失効する休暇の日数とその年月日
  - **取得履歴**: 直近の休暇取得日と日数を一覧で表示

#### 処理フロー
1. 従業員がシステムにログインし、ダッシュボードまたは休暇情報画面を開く。
2. システムは、ログイン中の従業員IDをキーに、従業員マスタおよび休暇申請テーブルから関連情報を取得する。
3. 取得した情報（付与日数、繰越日数、取得済み日数など）を基に、現在の休暇残日数を計算する。
4. 計算結果と関連情報を画面に整形して表示する。

#### エラー処理
- **データ取得失敗**: 従業員マスタ等から休暇情報が取得できなかった場合、<font color="red">「休暇情報を表示できませんでした。時間をおいて再度お試しください。」</font>等のエラーメッセージを表示する。

## データ設計
### データベース構造
#### 従業員マスタ (M_EMPLOYEE) の利用
休暇残日数の管理は、従業員マスタテーブルにカラムを追加して行うことを想定する。
| 項目名 | データ型 | 説明 |
|---|---|---|
| employee_id | VARCHAR(10) | 従業員ID |
| ... | ... | ... |
| **annual_leave_balance** | **DECIMAL(4,1)** | **現在の有給休暇残日数** |
| **last_grant_date** | **DATE** | **最終付与日** |

※残日数の計算ロジックは、付与ルールと休暇申請テーブルの承認済みレコードに基づいて動的に行い、結果をこのマスタに保持することも、都度計算することも考えられる。本設計では、バッチ処理等で定期的に計算しマスタに保持する方式を想定する。

## インターフェース設計
### 内部インターフェース
- **サーバー間通信**
  - プロトコル: HTTPS
  - データ形式: JSON
  - エンドポイント例:
    - GET /api/leaves/balance （自身の休暇残日数・詳細情報取得）

## 非機能要件
### 性能
- ログイン後のダッシュボード等での残日数表示は、1秒以内に完了すること。

### セキュリティ
- 従業員は自身の休暇残日数のみ閲覧可能とし、他人の情報には一切アクセスできないようにする。

## テスト計画
### 単体テスト
- 残日数の計算ロジック（繰越、付与、消化）が仕様通りであることを確認する。
- 画面に表示される各項目（残日数、内訳等）が、DBの値と一致することを確認する。

### 結合テスト
- 従業員が休暇を申請し、管理者が承認した際に、残日数が正しく減算され、本機能の表示に即時反映されることを確認する。

## 付録
### 用語集
- **残日数**: 取得可能な休暇の日数。
- **付与日数**: 会社規定に基づき、新たに従業員に与えられた休暇の日数。
- **繰越日数**: 前年度に使い切らず、次年度に持ち越された休暇の日数。

### 参考資料
- 日本IT業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025年6月版）