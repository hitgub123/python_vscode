# 基本設計書

## 1. ドキュメント概要
本基本設計書は、出退勤システムの要件に基づき、打刻履歴確認機能の基本設計を定義するものである。日本IT業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## 2. システム概要
本システムは、従業員が自身の過去の出退勤および休憩の打刻履歴を確認するための機能を備えた出退勤システムである。主な機能として、スマートフォンアプリまたはウェブインターフェースを用いた履歴確認機能を提供し、一般従業員が利用することを想定している。

## 3. 要件定義
### 3.1 要件一覧
| ID       | 分類             | 要件名         | 概要                                                                 | 利用者       |
|----------|------------------|----------------|----------------------------------------------------------------------|--------------|
| req-003  | 出退勤記録管理   | 打刻履歴確認   | 従業員は、自身の過去の打刻履歴（出社、退社、休憩など）をいつでも確認できる。 | 一般従業員   |

## 4. 機能設計
### 4.1 打刻履歴確認機能 (req-003)
#### 4.1.1 機能概要
従業員がスマートフォンアプリまたはウェブインターフェースを通じて、自身の過去の打刻履歴（出社、退社、休憩など）を閲覧する機能を提供する。履歴は指定期間で検索可能であり、リアルタイムで表示される。

#### 4.1.2 入力仕様
- **検索条件**
  - 期間：開始日および終了日（デフォルト：過去1ヶ月）
  - 打刻種別：出社/退社/休憩開始/休憩終了（複数選択可）
  - デバイス：スマートフォンアプリまたはウェブインターフェース
- **認証**
  - ユーザー認証（ログインID、パスワード、または生体認証）が必要。

#### 4.1.3 出力仕様
- **表示内容**
  - 打刻日時（JST）
  - 打刻種別（出社/退社/休憩開始/休憩終了）
  - デバイス種別（アプリ/ウェブ/ICカード）
  - 位置情報（リモート打刻の場合、設定に応じて表示）
- **表示形式**
  - リスト形式（日付順、降順）
  - オプション：CSVエクスポート機能
- **通知**
  - 検索結果が0件の場合、メッセージ表示（例：「指定期間に履歴がありません」）

#### 4.1.4 処理フロー
1. 利用者がアプリまたはウェブインターフェースで履歴確認画面にアクセス。
2. システムが利用者の認証を行う。
3. 利用者が検索条件（期間、打刻種別など）を入力。
4. システムがデータベースから該当する打刻履歴を取得。
5. 検索結果を利用者に表示。

#### 4.1.5 エラー処理
- **認証失敗**：エラーメッセージを表示（例：「ログイン情報が正しくありません」）。
- **無効な検索条件**：エラーメッセージを表示（例：「開始日が終了日より後です」）。
- **通信エラー**：エラーメッセージを表示し、再試行を促す。

## 5. データ設計
### 5.1 データベース構造
#### 5.1.1 打刻履歴テーブル (T_ATTENDANCE_LOG)
| 項目名            | データ型       | 説明                              | 主キー |
|-------------------|----------------|-----------------------------------|--------|
| log_id            | BIGINT         | 打刻ログID（自動採番）           | ○      |
| employee_id        | VARCHAR(10)    | 従業員ID                         |        |
| timestamp         | DATETIME       | 打刻時刻（JST）                  |        |
| attendance_type   | VARCHAR(2)     | 打刻種別（出社:01/退社:02/休憩開始:03/休憩終了:04） |        |
| device_type       | VARCHAR(2)     | デバイス種別（IC:01/アプリ:02/ウェブ:03） |        |
| location          | VARCHAR(100)   | 位置情報（GPS座標、任意）        |        |

## 6. インターフェース設計
### 6.1 外部インターフェース
- **スマートフォンアプリ**
  - OS：iOS 15以上、Android 10以上
  - API：RESTful API（JSON形式）
  - 認証：JWTトークンまたは生体認証
- **ウェブインターフェース**
  - 対応ブラウザ：Chrome、Firefox、Safari（最新バージョン）
  - API：RESTful API（JSON形式）
  - 認証：JWTトークン

### 6.2 内部インターフェース
- **サーバー間通信**
  - プロトコル：HTTPS
  - データ形式：JSON
  - エンドポイント例：
    - GET /api/attendance/history（打刻履歴取得）

## 7. 非機能要件
### 7.1 性能
- 履歴検索処理：2秒以内に完了
- 同時検索：最大100人/分

### 7.2 可用性
- 稼働率：99.9%
- メンテナンス時間：毎月第2日曜 0:00-3:00

### 7.3 セキュリティ
- データ暗号化：TLS 1.3
- 認証：多要素認証（アプリおよびウェブ）
- アクセス制限：自身の履歴のみ閲覧可能

## 8. テスト計画
### 8.1 単体テスト
- 各コンポーネント（検索条件入力、履歴取得、結果表示）の動作確認。
### 8.2 結合テスト
- アプリおよびウェブからの履歴検索が正しく表示されることを確認。
### 8.3 負荷テスト
- 100人同時検索時のレスポンスタイムを測定。

## 9. 運用・保守
### 9.1 運用体制
- サポート窓口：平日9:00-17:00
- 障害対応：24時間365日（緊急時）
### 9.2 保守内容
- 月次パッチ適用
- 年次システムアップデート

## 10. 付録
### 10.1 用語集
- 打刻：出社、退社、休憩開始、休憩終了の時刻を記録する行為
- アプリ：出退勤管理用スマートフォンアプリケーション
- ウェブインターフェース：ブラウザ経由でアクセスする打刻管理ページ

### 10.2 参考資料
- 日本IT業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025年6月版）