## 基本設計書

| ID      | fun-026                      |
| ------- | ---------------------------- |
| 分類    | 勤怠データの分析・レポート               |
| 機能名  | 残業・休日出勤レポート生成機能                   |
| 概要    | 人事部門が、全従業員の残業時間、休日出勤時間を集計し、レポートを生成できる。 |
| 利用者  | 人事部門                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、人事部門が全従業員の残業時間、休日出勤時間を集計し、レポートを生成することを目的とする。

### 2. 適用範囲

本機能は、人事部門の担当者が利用する。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 期間指定   | レポート対象期間      | 日付型   | 必須   | レポートの集計対象期間を指定                                                               |
| 部門指定   | レポート対象部門      | 文字列   | 任意   | 特定の部門のみを対象とする場合に指定。未指定時は全社。                                                                        |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 期間指定   | 開始日が終了日より未来の日付でないこと。                                                              |
| 部門指定   | 部門指定がある場合、指定された部門が部門マスタに登録されていること。                                                            |

### 4. 出力

| 項目       | 内容                               | 型       | 備考                               |
| ---------- | ---------------------------------- | -------- | ---------------------------------- |
| レポート   | 残業・休日出勤レポート             | ファイル | CSVまたはPDF形式で出力             |

レポートの出力項目例：

*   従業員ID
*   従業員名
*   所属部門
*   残業時間（指定期間の合計）
*   休日出勤時間（指定期間の合計）

### 5. 処理詳細

1.  人事担当者が、レポート生成画面で期間と部門（任意）を指定する。
2.  システムは、指定された期間と部門に基づいて、勤怠データ（残業時間、休日出勤時間）を抽出する。
3.  抽出されたデータを集計し、レポートを作成する。
4.  レポートを指定された形式（CSV/PDF）で出力する。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（期間指定不正、部門コードが存在しないなど）           | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。エラーログを出力する。</span>                                         |
| データ抽出エラー（勤怠データが存在しないなど）                                                        | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| レポート生成エラー（ファイル出力エラーなど）                                  | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |

### 7. 画面設計

*   レポート生成画面：
    *   期間指定フィールド（開始日、終了日）
    *   部門指定フィールド（プルダウンまたはテキスト入力）
    *   レポート形式選択（CSV/PDF）
    *   レポート生成ボタン
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：レポート出力権限は、人事権限を持つユーザーに限定する。
*   パフォーマンス：レポート生成処理は、データ量に応じて適切な時間で完了すること。必要に応じて、バッチ処理化を検討する。
*   ログ：レポート生成処理（成功/失敗）、パラメータをログに記録する。
