## 基本設計書

| ID      | fun-012                      |
| ------- | ---------------------------- |
| 分類    | 休暇管理                   |
| 機能名  | 全社休暇取得状況レポート機能                   |
| 概要    | 人事部門が全従業員の休暇取得状況（取得日数、残日数、取得傾向）を部門別、個人別に集計し、レポートとして出力できる。 |
| 利用者  | 人事部門                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、人事部門が全従業員の休暇取得状況を把握し、レポートとして出力することを目的とする。

### 2. 適用範囲

本機能は、人事部門の担当者が全従業員の休暇取得状況をレポートとして出力する際に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 期間指定   | レポート対象期間      | 日付型   | 必須   | レポートの集計対象となる期間                                                               |
| 部門指定   | レポート対象部門      | 文字列   | 任意   | 指定がない場合は全社                                                                       |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 期間指定   | 開始日が終了日より未来でないこと。                                                              |
| 部門指定   | 部門指定がある場合、指定された部門が組織マスタに登録されていること。                                                            |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 休暇取得状況レポート | 全従業員の休暇取得状況 | CSV/PDF | 部門別、個人別に集計された情報を含む |

レポートに含まれる項目例：

*   従業員ID
*   従業員名
*   所属部門
*   休暇種類
*   取得日数
*   残日数
*   取得開始日
*   取得終了日
*   取得傾向（例：年間取得日数、月間取得日数など）

### 5. 処理詳細

1.  人事部門担当者が、レポートの対象期間と部門（任意）を指定する。
2.  システムは、指定された期間と部門に基づいて、従業員の休暇情報をデータベースから抽出する。
3.  抽出された休暇情報を基に、部門別、個人別に休暇取得状況を集計する。
4.  集計結果を、指定された形式（CSV/PDFなど）でレポートとして出力する。
5.  レポートを出力する際、以下の情報を付加する。
    *   レポート作成日時
    *   レポート対象期間
    *   レポート対象部門（指定された場合）

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（期間指定が不正、部門が存在しないなど）           | <span style="color:red;">エラーメッセージを表示し、レポート処理を中断する。エラーログを出力する。</span>                                         |
| データベースからのデータ抽出エラー                                                        | <span style="color:red;">エラーメッセージを表示し、レポート処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| レポート生成エラー（CSV/PDFファイル作成失敗など）                                  | <span style="color:red;">エラーメッセージを表示し、レポート処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 指定された期間に休暇データが存在しない場合                                | データが存在しない旨のメッセージを表示し、空のレポートを出力するか、処理を中断するかを選択可能とする。<br><span style="color:red;">エラー発生時はエラーログを出力。</span> |

### 7. 画面設計

*   レポート生成画面：
    *   期間指定入力フィールド（開始日、終了日）
    *   部門指定選択フィールド
    *   レポート形式選択フィールド（CSV/PDF）
    *   レポート生成ボタン
    *   エラーメッセージ表示領域
    *   処理状況表示領域（例：〇〇件中〇〇件処理完了）

### 8. その他

*   セキュリティ：レポート出力権限は、人事部門の担当者のみに付与する。
*   パフォーマンス：レポート生成処理は、データ量に応じて適切な時間内に完了すること。必要に応じて、バッチ処理化を検討する。
*   ログ：レポート生成処理の実行履歴（実行日時、実行者、対象期間、対象部門、結果）をログに記録する。
