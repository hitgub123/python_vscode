## 基本設計書

| ID      | fun-029                      |
| ------- | ---------------------------- |
| 分類    | 勤怠データの分析・レポート               |
| 機能名  | 時間外労働集計レポート自動生成機能                   |
| 概要    | 労働基準法に準拠した時間外労働の集計レポートを自動で生成する。 |
| 利用者  | 人事部門, 経理部門                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、労働基準法に準拠した時間外労働の集計レポートを自動で生成することを目的とする。

### 2. 適用範囲

本機能は、人事部門および経理部門が時間外労働時間を確認する際に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 集計期間開始日   | レポートの集計を開始する日付     | 日付型   | 必須   |  YYYY/MM/DD形式                                                                              |
| 集計期間終了日   | レポートの集計を終了する日付     | 日付型   | 必須   |  YYYY/MM/DD形式                                                                              |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 集計期間開始日   | 集計期間終了日より前の日付であること。                                                              |
| 集計期間終了日   | 集計期間開始日より後の日付であること。                                                            |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 時間外労働集計レポート | 労働基準法に準拠した形式のレポート | PDF, CSVなど   |  時間外労働時間、深夜労働時間などを含む |

### 5. 処理詳細

1.  システムは、入力された集計期間（開始日、終了日）を取得する。
2.  指定された集計期間に基づいて、従業員の勤怠データ（出勤、退勤、休憩時間など）をデータベースから抽出する。
3.  抽出された勤怠データをもとに、従業員ごとの時間外労働時間、深夜労働時間などを計算する。
4.  計算された時間外労働時間などを、労働基準法に準拠した形式でレポートとして生成する。
5.  生成されたレポートを指定された形式（PDF, CSVなど）で出力する。
6.  レポートの生成が成功した場合、完了メッセージをシステム管理者に通知する。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（集計期間の開始日が終了日より後であるなど）           | <span style="color:red;">エラーメッセージをシステム管理者に表示し、レポート生成処理を中断する。エラーログを出力する。</span>                                         |
| データベースからのデータ抽出エラー                                                        | <span style="color:red;">エラーメッセージをシステム管理者に表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| レポート生成処理中のエラー                                  | <span style="color:red;">エラーメッセージをシステム管理者に表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 該当する勤怠データが存在しない場合                                | レポートは生成せず、該当データがない旨をシステム管理者に通知する。<br><span style="color:red;">エラー発生時はエラーログを出力。</span> |

### 7. 画面設計

*   レポート生成画面（管理画面）：
    *   集計期間（開始日、終了日）入力フィールド
    *   レポート形式選択（PDF, CSVなど）
    *   レポート生成ボタン
    *   処理状況表示領域
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：レポートへのアクセス権限は、人事部門および経理部門の担当者に限定する。
*   パフォーマンス：レポート生成処理は、従業員数に応じて適切な時間内に完了すること。
*   ログ：全てのレポート生成処理（成功/失敗）をログに記録する。
