## 基本設計書

| ID      | fun-003                  |
| ------- | ------------------------ |
| 分類    | 出退勤記録管理           |
| 機能名  | リモート打刻機能           |
| 概要    | リモートワーク中の従業員が、PCまたはスマートフォンアプリから出退勤を打刻できる。 |
| 利用者  | 一般従業員               |
| 作成者  |                           |
| 作成日付 |                           |

### 1. 目的

本機能は、リモートワーク中の従業員が、PCまたはスマートフォンアプリから出退勤を打刻できるようにすることを目的とする。

### 2. 適用範囲

本機能は、リモートワークを行う一般従業員の出退勤時に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 従業員ID   | 従業員を識別するID     | 文字列   | 必須   | 社員番号など                                                                               |
| 打刻種別   | 出勤または退勤の区分   | 列挙型   | 必須   | 出勤 or 退勤                                                                              |
| 打刻時刻   | 打刻を行った日時       | 日時型   | 必須   | システムの現在時刻                                                                        |
| 利用デバイス | 打刻に使用するデバイス | 列挙型   | 必須   | PC or スマホ                                                                                |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 従業員ID   | 社員マスタに登録されているIDであること。                                                              |
| 打刻時刻   | 未来の日時でないこと。過去の日時であること。                                                            |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 打刻時刻   | 打刻された時刻           | 日時型   | システムに記録される時刻           |
| 従業員ID   | 打刻を行った従業員のID    | 文字列   | 記録の紐付けに使用                 |
| 打刻種別   | 打刻の種類（出勤/退勤）   | 列挙型   |                                    |
| 利用デバイス | 打刻に使用されたデバイス | 列挙型   |                                    |

### 5. 処理詳細

1.  従業員がPCまたはスマートフォンアプリで打刻を行う。
2.  システムは、入力された従業員ID、打刻種別、打刻時刻、利用デバイスを取得する。
3.  取得した情報を基に、出退勤情報をシステムに記録する。具体的には、出勤テーブルまたは退勤テーブルに以下の情報を登録する。
    *   従業員ID
    *   打刻時刻
    *   打刻種別
    *   利用デバイス
4.  打刻処理が成功した場合、従業員に打刻完了メッセージを表示する。

### 6. 例外処理

| 条件                                                                                             | 対応                                                                                                                                                         |
| ------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 入力チェックエラー（従業員IDが存在しない、打刻時刻が未来であるなど）                                                   | <span style="color:red;">エラーメッセージを従業員に表示し、打刻処理を中断する。エラーログを出力する。</span>                                                                           |
| データベースへの書き込みエラー                                                                    | <span style="color:red;">エラーメッセージを従業員に表示し、打刻処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                                                           |
| PCまたはスマートフォンアプリとの通信エラー                                                           | <span style="color:red;">エラーメッセージを従業員に表示し、再試行を促す。システム管理者に通知する。エラーログを出力する。</span>                                                           |
| 出勤打刻時に、未退勤のデータが存在する場合                                                               | <span style="color:red;">エラーメッセージを表示し、二重打刻を防止する。</span>                                                                                           |
| 退勤打刻時に、出勤データが存在しない場合                                                               | <span style="color:red;">エラーメッセージを表示し、打刻処理を中断する。</span>                                                                                           |

### 7. 画面設計

*   打刻画面（PC/スマートフォンアプリ）：
    *   出勤/退勤ボタン
    *   打刻完了メッセージ表示領域
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：従業員IDは暗号化してシステム内で管理する。
*   パフォーマンス：打刻処理は、3秒以内に完了すること。
*   ログ：全ての打刻処理（成功/失敗）をログに記録する。
