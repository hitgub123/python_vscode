## 基本設計書

| ID      | fun-014                      |
| ------- | ---------------------------- |
| 分類    | 残業管理               |
| 機能名  | 残業申請機能                   |
| 概要    | 従業員が予定される残業時間と理由を記載し、オンラインで残業申請を行える。 |
| 利用者  | 一般従業員                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、従業員が予定される残業時間と理由を記載し、オンラインで残業申請を行うことを目的とする。

### 2. 適用範囲

本機能は、一般従業員が残業を行う際に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 従業員ID   | 従業員を識別するID     | 文字列   | 必須   | 社員番号など                                                                               |
| 残業予定日 | 残業を行う予定の日付   | 日付型   | 必須   |                                                                                            |
| 開始時刻   | 残業を開始する予定時刻 | 時刻型   | 必須   |                                                                                            |
| 終了時刻   | 残業を終了する予定時刻 | 時刻型   | 必須   |                                                                                            |
| 理由       | 残業を行う理由         | 文字列   | 必須   | 具体的な理由を記載                                                                         |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 従業員ID   | 社員マスタに登録されているIDであること。                                                              |
| 残業予定日 | 過去の日付でないこと。                                                            |
| 開始時刻   | 終了時刻より前の時刻であること。                                                            |
| 終了時刻   | 開始時刻より後の時刻であること。                                                            |
| 理由       | 文字数が規定の範囲内であること。（例：200文字以内）                               |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 申請ID     | 申請を識別するID         | 数値型   | 自動採番                             |
| 従業員ID   | 申請を行った従業員のID    | 文字列   |                                    |
| 残業予定日 | 申請された残業予定日     | 日付型   |                                    |
| 開始時刻   | 申請された残業開始時刻   | 時刻型   |                                    |
| 終了時刻   | 申請された残業終了時刻   | 時刻型   |                                    |
| 理由       | 申請された残業理由       | 文字列   |                                    |
| 申請日時   | 申請が行われた日時       | 日時型   | システムの現在日時                   |
| 承認状況   | 申請の承認状況           | 列挙型   | 未承認、承認済、却下                 |

### 5. 処理詳細

1.  従業員が残業申請画面で、残業予定日、開始時刻、終了時刻、理由を入力し、申請ボタンを押下する。
2.  システムは、入力された情報を取得し、入力チェックを行う。（入力項目の必須チェック、日付・時刻の整合性チェック、文字数チェックなど）
3.  入力チェックに問題がなければ、残業申請データをデータベースに登録する。
4.  申請IDを自動採番し、申請日時を記録する。
5.  残業申請データ登録後、管理職へ承認依頼の通知を行う。（メール通知など）
6.  申請完了メッセージを従業員に表示する。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（必須項目未入力、日付・時刻の整合性エラー、文字数オーバーなど） | <span style="color:red;">エラーメッセージを従業員に表示し、申請処理を中断する。エラーログを出力する。</span>                                         |
| データベースへの書き込みエラー                                                        | <span style="color:red;">エラーメッセージを従業員に表示し、申請処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 管理職への通知エラー（メール送信失敗など）                                              | <span style="color:red;">申請処理は継続し、エラーログを出力する。システム管理者に通知する。</span>                                                        |
| 同一従業員が同じ日に複数の残業申請を行った場合                                  | 最新の申請で上書きするか、エラーメッセージを表示して申請を拒否するかを設定で選択可能とする。<br><span style="color:red;">エラー発生時はエラーログを出力。</span> |

### 7. 画面設計

*   残業申請画面：
    *   従業員ID（自動表示、変更不可）
    *   残業予定日入力フィールド（カレンダー表示）
    *   開始時刻入力フィールド（プルダウンまたは時刻入力）
    *   終了時刻入力フィールド（プルダウンまたは時刻入力）
    *   理由入力フィールド（テキストエリア）
    *   申請ボタン
    *   申請完了メッセージ表示領域
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：従業員IDは暗号化してシステム内で管理する。
*   パフォーマンス：申請処理は、3秒以内に完了すること。
*   ログ：全ての申請処理（成功/失敗）をログに記録する。
*   承認フロー：申請された残業は、所属部署の管理職による承認が必要となる。承認フローについては別途詳細設計を行う。
