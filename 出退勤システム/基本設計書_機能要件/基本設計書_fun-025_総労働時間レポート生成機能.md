## 基本設計書

| ID      | fun-025                      |
| ------- | ---------------------------- |
| 分類    | 勤怠データの分析・レポート               |
| 機能名  | 総労働時間レポート生成機能                   |
| 概要    | 人事部門が、全従業員の月次・四半期・年次の総労働時間を集計し、レポートを生成できる。 |
| 利用者  | 人事部門                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、人事部門が全従業員の月次・四半期・年次の総労働時間を集計し、レポートを生成することを目的とする。

### 2. 適用範囲

本機能は、人事部門の担当者が利用する。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 期間指定   | 集計対象期間を指定     | 日付型   | 必須   | 月次、四半期、年次を選択可能                                                               |
| 部門指定   | 集計対象部門を指定     | 文字列   | 任意   | 全社を選択した場合、全従業員が対象                                                                        |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 期間指定   | 過去の期間であること。未来の期間は指定できないこと。                                                              |
| 部門指定   | 指定された部門が、部門マスタに登録されていること。                                                            |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 総労働時間レポート | 集計された総労働時間データ | CSV/PDF | 指定された形式で出力                 |

### 5. 処理詳細

1.  人事部門担当者が、期間（月次、四半期、年次）および部門（任意）を指定する。
2.  システムは、指定された期間および部門に該当する従業員の勤怠データを抽出する。
3.  抽出された勤怠データから、従業員ごとの総労働時間を集計する。
4.  集計結果を、指定された形式（CSV/PDF）でレポートとして出力する。
5.  レポートには、以下の情報が含まれる。
    *   従業員ID
    *   従業員名
    *   所属部門
    *   指定期間
    *   総労働時間

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（期間指定が不正、部門が存在しないなど）           | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。エラーログを出力する。</span>                                         |
| 勤怠データが存在しない場合                                                        | レポートに「該当データなし」と表示する。                                                        |
| データベースへのアクセスエラー                                                        | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| レポート生成処理中にエラーが発生した場合                                  | <span style="color:red;">エラーメッセージを表示し、レポート生成処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |

### 7. 画面設計

*   レポート生成画面：
    *   期間指定（プルダウンメニュー：月次、四半期、年次）
    *   部門指定（テキストボックスまたはプルダウンメニュー）
    *   出力形式指定（ラジオボタン：CSV、PDF）
    *   レポート生成ボタン
    *   エラーメッセージ表示領域
    *   処理状況表示（プログレスバーなど）

### 8. その他

*   セキュリティ：レポート出力権限は、人事部門の担当者に限定する。
*   パフォーマンス：レポート生成処理は、データ量に応じて適切な時間で完了すること。必要に応じて、バッチ処理を検討する。
*   ログ：レポート生成処理の実行履歴をログに記録する。
