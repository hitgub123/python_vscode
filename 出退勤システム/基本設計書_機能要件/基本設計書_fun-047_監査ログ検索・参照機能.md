## 基本設計書

| ID      | fun-047                      |
| ------- | ---------------------------- |
| 分類    | セキュリティ・データ管理               |
| 機能名  | 監査ログ検索・参照機能                   |
| 概要    | 記録された監査ログを、ユーザー、操作種別、日付などで検索し、詳細を確認できる。 |
| 利用者  | システム管理者, 人事部門                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、記録された監査ログを、システム管理者または人事部門がユーザー、操作種別、日付などの条件で検索し、詳細を確認できるようにすることを目的とする。

### 2. 適用範囲

本機能は、システム管理者および人事部門が監査ログを検索・参照する際に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                               | 型       | 必須   | 備考                                                                                       |
| ---------- | ---------------------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| ユーザー   | 検索対象のユーザー                 | 文字列   | 任意   | ユーザーIDまたはユーザー名                                                                   |
| 操作種別   | 検索対象の操作種別                 | 列挙型   | 任意   | ログイン、ログアウト、データ変更など                                                         |
| 開始日付   | 検索対象期間の開始日               | 日付型   | 必須   |                                                                                            |
| 終了日付   | 検索対象期間の終了日               | 日付型   | 必須   |                                                                                            |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 開始日付   | 終了日付以前の日付であること。                                                              |
| 終了日付   | 開始日付以降の日付であること。                                                            |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 監査ログ一覧 | 検索条件に合致する監査ログの一覧 | テーブル | 各ログの詳細情報を含む             |

監査ログ一覧の項目:

| 項目       | 内容                               | 型       | 備考                               |
| ---------- | ---------------------------------- | -------- | ---------------------------------- |
| ユーザー   | 操作を行ったユーザー                 | 文字列   | ユーザーIDまたはユーザー名                                                                   |
| 操作種別   | 操作の種類                         | 文字列   | ログイン、ログアウト、データ変更など                                                         |
| 操作日時   | 操作が行われた日時                   | 日時型   |                                                                                            |
| 詳細       | 操作の詳細情報                     | 文字列   | 変更内容、アクセスしたデータなど                                                               |

### 5. 処理詳細

1.  システム管理者または人事部門が、検索条件（ユーザー、操作種別、期間など）を入力する。
2.  システムは、入力された検索条件に基づいて監査ログデータベースを検索する。
3.  検索条件に合致する監査ログを抽出し、一覧形式で表示する。
4.  ユーザーは、一覧から特定の監査ログを選択し、詳細情報を確認できる。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（日付の形式が不正、開始日が終了日より後など）           | <span style="color:red;">エラーメッセージを表示し、検索処理を中断する。エラーログを出力する。</span>                                         |
| データベースへのアクセスエラー                                                        | <span style="color:red;">エラーメッセージを表示し、検索処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 検索結果が0件の場合                                  | 検索結果が0件である旨をメッセージで表示する。                                                        |

### 7. 画面設計

*   監査ログ検索画面：
    *   検索条件入力フィールド（ユーザー、操作種別、開始日付、終了日付）
    *   検索ボタン
    *   検索結果表示領域（監査ログ一覧）
    *   詳細表示ボタン（各監査ログに対して）
*   監査ログ詳細画面：
    *   監査ログの詳細情報表示領域

### 8. その他

*   セキュリティ：監査ログへのアクセスは、システム管理者および人事部門に限定する。
*   パフォーマンス：検索処理は、5秒以内に完了すること。
*   ログ：全ての検索操作をログに記録する。
