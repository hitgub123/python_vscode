## 基本設計書

| ID      | fun-022                      |
| ------- | ---------------------------- |
| 分類    | シフト管理                   |
| 機能名  | シフト変更申請機能               |
| 概要    | 従業員がシフト変更を希望する場合、希望日時と理由を記載してオンラインで申請できる。 |
| 利用者  | 一般従業員                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、従業員がシフト変更を希望する場合に、オンラインで申請を行うことを目的とする。

### 2. 適用範囲

本機能は、一般従業員が自身のシフト変更を希望する場合に適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 従業員ID   | 従業員を識別するID     | 文字列   | 必須   | 社員番号など                                                                               |
| 変更希望日 | シフト変更を希望する日 | 日付型   | 必須   |                                                                                            |
| 変更希望シフト | 変更を希望するシフト   | 文字列   | 必須   | 例：早番、遅番、夜勤                                                                       |
| 理由       | シフト変更を希望する理由 | 文字列   | 必須   | 自由記述                                                                                   |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 従業員ID   | 社員マスタに登録されているIDであること。                                                              |
| 変更希望日 | 過去の日付でないこと。                                                            |
| 変更希望シフト | 定義されたシフトパターンの中から選択されていること。                               |
| 理由       | 文字数制限を超えていないこと。                                                              |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| 申請ID     | シフト変更申請を識別するID | 数値     | 自動採番                             |
| 従業員ID   | 申請を行った従業員のID    | 文字列   |                                    |
| 変更希望日 | 申請された変更希望日       | 日付型   |                                    |
| 変更希望シフト | 申請された変更希望シフト   | 文字列   |                                    |
| 理由       | 申請された理由             | 文字列   |                                    |
| 申請日時   | 申請が行われた日時         | 日時型   | システムの現在時刻                   |
| 申請ステータス | 申請のステータス           | 列挙型   | 例：申請中、承認済、却下             |

### 5. 処理詳細

1.  従業員がシフト変更申請画面で、従業員ID、変更希望日、変更希望シフト、理由を入力し、申請ボタンを押下する。
2.  システムは、入力された情報を取得し、申請データを作成する。
3.  作成された申請データに、申請ID、申請日時、申請ステータス（初期値：申請中）を付与する。
4.  申請データをデータベースに登録する。
5.  管理職へシフト変更申請があったことを通知する。（メール通知など）
6.  申請完了メッセージを従業員に表示する。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（従業員IDが存在しない、日付が過去であるなど）           | <span style="color:red;">エラーメッセージを従業員に表示し、申請処理を中断する。エラーログを出力する。</span>                                         |
| データベースへの書き込みエラー                                                        | <span style="color:red;">エラーメッセージを従業員に表示し、申請処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 管理職への通知エラー                                                              | <span style="color:red;">申請処理は継続し、エラーログを出力する。システム管理者に通知する。</span>                                         |

### 7. 画面設計

*   シフト変更申請画面：
    *   従業員ID入力フィールド（自動表示）
    *   変更希望日選択カレンダー
    *   変更希望シフト選択プルダウン
    *   理由入力テキストエリア
    *   申請ボタン
    *   申請完了メッセージ表示領域
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：従業員IDは暗号化してシステム内で管理する。
*   パフォーマンス：申請処理は、3秒以内に完了すること。
*   ログ：全ての申請処理（成功/失敗）をログに記録する。
