## 基本設計書

| ID      | fun-049                      |
| ------- | ---------------------------- |
| 分類    | セキュリティ・データ管理               |
| 機能名  | データ復元機能                   |
| 概要    | バックアップされたデータを用いて、システムデータを過去の時点に復元できる。 |
| 利用者  | システム管理者                   |
| 作成者  |                               |
| 作成日付 |                               |

### 1. 目的

本機能は、バックアップされたデータを用いて、システムデータを過去の時点に復元することを目的とする。

### 2. 適用範囲

本機能は、システムデータの復元が必要な場合に、システム管理者によって適用される。

### 3. 入力

#### 入力項目

| 項目       | 内容                  | 型       | 必須   | 備考                                                                                       |
| ---------- | --------------------- | -------- | ------ | ------------------------------------------------------------------------------------------ |
| 復元対象日時   | 復元したい過去の時点   | 日時型   | 必須   | 復元するデータの基準となる日時                                                                               |

#### 業務Check

| 項目       | 内容                                                                                   |
| ---------- | ------------------------------------------------------------------------------------ |
| 復元対象日時   | 過去の日時であること。未来の日時でないこと。                                                            |
| 復元対象日時   | バックアップデータが存在する日時であること。                                                              |

### 4. 出力

| 項目       | 内容                     | 型       | 備考                               |
| ---------- | ------------------------ | -------- | ---------------------------------- |
| システムデータ   | 復元されたシステムデータ       |  | 過去の時点のデータで上書きされる |

### 5. 処理詳細

1.  システム管理者が復元対象日時を指定する。
2.  システムは、指定された復元対象日時のバックアップデータを検索する。
3.  バックアップデータが存在する場合、システム管理者に確認を求める。
4.  システム管理者が復元を実行する場合、システムはバックアップデータを用いてシステムデータを復元する。
5.  復元処理が完了した場合、システム管理者に完了メッセージを表示する。

### 6. 例外処理

| 条件                                                                    | 対応                                                                                                                       |
| ----------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| 入力チェックエラー（復元対象日時が未来である、バックアップデータが存在しないなど）           | <span style="color:red;">エラーメッセージをシステム管理者に表示し、復元処理を中断する。エラーログを出力する。</span>                                         |
| データベースへの書き込みエラー                                                        | <span style="color:red;">エラーメッセージをシステム管理者に表示し、復元処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |
| 復元処理中に予期せぬエラーが発生した場合                                  | <span style="color:red;">エラーメッセージをシステム管理者に表示し、復元処理を中断する。システム管理者に通知する。エラーログを出力する。</span>                         |

### 7. 画面設計

*   データ復元画面：
    *   復元対象日時入力フィールド
    *   復元実行ボタン
    *   復元完了メッセージ表示領域
    *   エラーメッセージ表示領域

### 8. その他

*   セキュリティ：復元処理は、特定の権限を持つシステム管理者のみが実行可能とする。
*   パフォーマンス：データ量に応じて復元処理時間が変動する可能性があることを考慮する。
*   ログ：全ての復元処理（成功/失敗）をログに記録する。
