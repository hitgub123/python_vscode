
# 基本設計書

## ドキュメント概要

本基本設計書は、出退勤システムの要件に基づき、チーム勤怠ダッシュボード機能の基本設計を定義するものである。日本 IT 業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要

本システムは、従業員の出退勤時刻を正確に記録・管理するための出退勤システムである。本設計書では、管理職がチームの勤怠状況を一覧で確認できるチーム勤怠ダッシュボード機能について定義する。

## 要件定義

### 要件一覧

| ID      | 分類                       | 要件名                   | 概要                                                                                                             | 利用者 |
| ------- | -------------------------- | ------------------------ | ---------------------------------------------------------------------------------------------------------------- | ------ |
| req-022 | 勤怠データの分析・レポート | チーム勤怠ダッシュボード | 管理職は、自身のチームの遅刻、早退、欠勤、時間外労働などの勤怠状況を一覧で確認できるダッシュボードを利用できる。 | 管理職 |

## 機能設計

### チーム勤怠ダッシュボード機能 (req-022)

#### 機能概要

管理職が、Web アプリケーションを通じて、自身が管轄するチームメンバーの勤怠状況を一覧で確認できるダッシュボードを提供する。

#### 入力仕様

- **Web アプリケーション**
  - **期間**: 選択式（例：当月、先月、過去 3 ヶ月、指定期間）
  - **表示項目**: 選択式（例：遅刻回数、早退回数、欠勤日数、時間外労働時間、有給取得日数）
  - **チーム**: 選択式（管理者が複数のチームを管轄している場合）

#### 出力仕様

- **画面表示**
  - ダッシュボード形式で、チームメンバーごとの勤怠状況を表示する。
  - 各項目は、一覧表、グラフ（棒グラフ、円グラフなど）で表示を切り替え可能とする。
  - 各メンバーの氏名をクリックすると、詳細な勤怠データ（日ごとの出退勤記録など）を表示する画面へ遷移できる。
- **データ出力**
  - 表示されているデータを CSV 形式でダウンロード可能とする。

#### 処理フロー

1. 管理職がシステムにログインし、チーム勤怠ダッシュボード画面を開く。
2. 管理職が期間、表示項目、チームを選択する（初期表示設定がある場合は、初期設定で表示）。
3. システムが、選択された条件に基づいて勤怠データを集計する。
4. システムが、集計結果をダッシュボード形式で画面に表示する。

#### エラー処理

- **データ不足**: 選択された期間に該当する勤怠データが存在しない場合、「該当するデータが見つかりません。」等のメッセージを表示する。
- <span style="color:red">**権限エラー**: 管理職が管轄外のチームのデータを閲覧しようとした場合、「アクセス権がありません。」等のエラーメッセージを表示する。</span>
- <span style="color:red">**システムエラー**: データベース接続エラーなど、システム側の問題が発生した場合、「システムエラーが発生しました。システム管理者に連絡してください。」等のエラーメッセージを表示する。</span>

## データ設計

### データベース構造

#### 【参照】従業員マスタ (M_EMPLOYEE)

- employee_id (VARCHAR(10)): 従業員 ID
- employee_name (VARCHAR(50)): 従業員名
- team_id (VARCHAR(10)): チーム ID
- position (VARCHAR(20)): 役職

#### 【参照】勤怠データテーブル (T_ATTENDANCE)

- attendance_date (DATE): 出勤日
- employee_id (VARCHAR(10)): 従業員 ID
- clock_in_time (DATETIME): 出勤時刻
- clock_out_time (DATETIME): 退勤時刻
- leave_type (VARCHAR(2)): 休暇種別コード

#### 【新規】チーム勤怠集計テーブル (T_TEAM_ATTENDANCE_SUMMARY) ※必要に応じて

| 項目名            | データ型     | 説明           | 主キー |
| ----------------- | ------------ | -------------- | ------ |
| team_id           | VARCHAR(10)  | チーム ID      | ○      |
| target_date       | DATE         | 集計対象日     | ○      |
| late_count        | INT          | 遅刻回数       |        |
| early_leave_count | INT          | 早退回数       |        |
| absence_days      | DECIMAL(5,1) | 欠勤日数       |        |
| overtime_hours    | DECIMAL(5,2) | 時間外労働時間 |        |

## インターフェース設計

### 内部インターフェース

- **サーバー間通信**
  - プロトコル: HTTPS
  - データ形式: JSON
  - エンドポイント例:
    - GET /api/teams/{team_id}/attendance/summary （チーム勤怠サマリーデータ取得）

## 非機能要件

### 性能

- ダッシュボード表示: 100 人規模のチームデータ表示が 5 秒以内に完了すること。
- データ集計処理: バッチ処理で、深夜帯に実施することを想定。

### セキュリティ

- 管理職は、自身が管轄するチームのデータのみ閲覧可能とする。
- 認証認可機能を強化し、不正アクセスを防止する。

## テスト計画

### 単体テスト

- 期間、表示項目、チームの選択が正しく機能することを確認する。
- 勤怠データの集計ロジックが正しく機能することを確認する。
- ダッシュボードの表示形式（一覧表、グラフ）が正しく表示されることを確認する。

### 結合テスト

- 従業員マスタ、勤怠データテーブルとの連携が正しく機能することを確認する。
- 権限設定に基づき、管理職が管轄外のチームデータを閲覧できないことを確認する。

## 付録

### 用語集

- **チーム勤怠ダッシュボード**: 管理職がチームメンバーの勤怠状況を一覧で確認できる画面。
- **遅刻**: 定刻より遅れて出勤すること。
- **早退**: 定刻より早く退勤すること。

### 参考資料

- 日本 IT 業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025 年 6 月版）

