
# 基本設計書

## ドキュメント概要

本基本設計書は、出退勤システムの要件に基づき、システムの基本設計を定義するものである。日本 IT 業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要

本システムは、従業員の出退勤時刻を正確に記録・管理するための出退勤システムである。本設計書では、人事部門向けの勤怠レポート生成機能について定義する。

## 要件定義

### 要件一覧

| ID      | 分類                       | 要件名           | 概要                                                                                                                             | 利用者   |
| ------- | -------------------------- | ---------------- | -------------------------------------------------------------------------------------------------------------------------------- | -------- |
| req-021 | 勤怠データの分析・レポート | 勤怠レポート生成 | 人事部門は、月次、四半期、年次で、全従業員の総労働時間、残業時間、休日出勤、休暇取得状況などを集計した詳細レポートを生成できる。 | 人事部門 |

## 機能設計

### 勤怠レポート生成機能 (req-021)

#### 機能概要

人事部門が、Web アプリケーションを通じて、指定された期間（月次、四半期、年次）における従業員の勤怠データを集計し、レポートを生成する機能を提供する。

#### 入力仕様

- **Web アプリケーション**
  - **レポート種別**: 選択式（月次、四半期、年次）
  - **対象期間**:
    - 開始日 (YYYY-MM-DD)
    - 終了日 (YYYY-MM-DD)
    - レポート種別に応じて、自動的に期間が設定されるようにする（例：月次の場合、指定した月の 1 日から末日まで）。
  - **出力形式**: 選択式（CSV, Excel, PDF）
  - **対象従業員**:
    - 全従業員
    - 特定の部署
    - 特定の従業員（複数選択可）

#### 出力仕様

- **ファイル出力**
  - 指定された出力形式で、勤怠レポートファイルを生成する。
  - ファイル名形式: `attendance_report_[レポート種別]_[開始日]_[終了日].[拡張子]` (例: `attendance_report_monthly_2024-07-01_2024-07-31.csv`)
- **レポート内容 (例 - CSV 形式)**
  ```csv
  従業員ID,従業員名,部署,総労働時間,残業時間,休日出勤日数,有給取得日数,欠勤日数
  1001,山田太郎,開発部,160.0,10.5,2,5,0
  1002,田中花子,人事部,155.0,5.0,0,3,1
  ...
  ```
````

- **レポート内容 (共通)**
  - 従業員 ID
  - 従業員名
  - 部署
  - 総労働時間
  - 残業時間
  - 休日出勤日数
  - 有給取得日数
  - 欠勤日数
  - その他、システムで管理されている勤怠関連情報

#### 処理フロー

1. 人事担当者がシステムにログインし、勤怠レポート生成画面を開く。
2. 人事担当者がレポート種別、対象期間、出力形式、対象従業員等の必要項目を選択・入力し、「レポート生成」ボタンを押下する。
3. システムが入力内容に基づき、データベースから勤怠データを抽出する。
4. システムが抽出されたデータを集計し、指定された形式でレポートを生成する。
5. システムが生成されたレポートファイルをダウンロード可能な状態で提供する。
6. システムが、処理完了メッセージを表示する。

#### エラー処理

- **入力不備**: 必須項目が未入力の場合や、日付の形式が不正な場合、エラーメッセージを表示し再入力を促す。
- **データ不足**: 指定された期間に勤怠データが存在しない場合、「指定された期間の勤怠データが見つかりません。」等のエラーメッセージを表示する。
- <span style="color:red;">**権限不足**: 人事権限を持たないユーザーがレポート生成を試みた場合、「権限がありません。」等のエラーメッセージを表示し、処理を中断する。</span>
- <span style="color:red;">**ファイル生成失敗**: レポートファイルの生成に失敗した場合（例：ディスク容量不足、アクセス権限不足）、「レポートファイルの生成に失敗しました。システム管理者にお問い合わせください。」等のエラーメッセージを表示する。</span>

## データ設計

### データベース構造

- 既存の従業員テーブル、勤怠テーブル、休暇申請テーブル等のデータを参照する。
- レポート生成のための一時テーブルは作成しない（パフォーマンスに問題がある場合は検討）。

## インターフェース設計

### 内部インターフェース

- **データベースアクセス**
  - SQL クエリを使用して、勤怠データを抽出する。
  - パフォーマンスを考慮し、適切なインデックスを設定する。
- **ファイル生成ライブラリ**
  - CSV, Excel, PDF 形式のファイル生成には、それぞれ適切なライブラリを使用する。

## 非機能要件

### 性能

- レポート生成処理: 対象従業員数が 1000 名の場合、10 秒以内に完了すること。

### セキュリティ

- 人事権限を持つユーザーのみが、勤怠レポート生成機能を利用できること。
- 生成されたレポートファイルへのアクセス制御を適切に行うこと。

## テスト計画

### 単体テスト

- レポート生成画面の入力バリデーション（必須項目、日付の妥当性）が正しく機能することを確認する。
- 生成されたレポートファイルの形式が正しいことを確認する。
- 集計結果が正しいことを、サンプルデータを用いて検証する。

### 結合テスト

- 人事権限を持つユーザーのみがレポート生成できることを確認する。
- 大量のデータでレポート生成を行い、性能要件を満たすことを確認する。

## 付録

### 用語集

- **勤怠レポート**: 従業員の労働時間、残業時間、休暇取得状況などを集計したレポート。
- **人事権限**: 勤怠レポート生成機能を利用するための権限。

### 参考資料

- 日本 IT 業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025 年 6 月版）
