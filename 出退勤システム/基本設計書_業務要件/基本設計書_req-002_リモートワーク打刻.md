# 基本設計書

## ドキュメント概要

本基本設計書は、出退勤システムの要件に基づき、リモートワーク打刻機能の基本設計を定義するものである。日本 IT 業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要

本システムは、リモートワーク中の従業員が自宅からでも出社および退社時刻を正確に記録するための機能を備えた出退勤システムである。主な機能として、スマートフォンアプリまたはウェブインターフェースを用いたリモート打刻機能を提供し、一般従業員が利用することを想定している。

## 要件定義

### 要件一覧

| ID      | 分類           | 要件名             | 概要                                                                      | 利用者     |
| ------- | -------------- | ------------------ | ------------------------------------------------------------------------- | ---------- |
| req-002 | 出退勤記録管理 | リモートワーク打刻 | リモートワーク中の従業員は、自宅からでも出社/退社時刻を正確に記録できる。 | 一般従業員 |

## 機能設計

### リモートワーク打刻機能 (req-002)

#### 機能概要

リモートワーク中の従業員がスマートフォンアプリまたはウェブインターフェースを使用して、出社および退社時刻を記録する機能を提供する。打刻データはリアルタイムでサーバーに送信され、正確な時刻管理を行う。

#### 入力仕様

- **スマートフォンアプリ打刻**
  - アプリ上で「出社」または「退社」ボタンを押下。
  - ユーザー認証（ログイン ID、パスワード、または生体認証）後、打刻時刻を送信。
- **ウェブインターフェース打刻**
  - ブラウザ上で専用ページにアクセスし、「出社」または「退社」ボタンを押下。
  - ユーザー認証（ログイン ID、パスワード）後、打刻時刻を送信。
- **共通**
  - 打刻時刻：システム時刻（JST）を基準に記録。
  - 打刻種別：出社/退社を識別。
  - 位置情報（任意）：打刻時の GPS データを記録（プライバシー設定に応じて無効化可能）。

#### 出力仕様

- 打刻完了後、利用者に以下を通知：
  - 打刻時刻
  - 打刻種別（出社/退社）
  - 処理結果（成功/失敗）
- 通知方法：
  - スマートフォンアプリ：プッシュ通知および画面表示
  - ウェブインターフェース：画面表示およびメール通知（設定に応じて）

#### 処理フロー

1. 利用者がアプリまたはウェブインターフェースで打刻操作を行う。
2. システムが利用者の認証を行う（ログイン情報または生体認証）。
3. 認証成功後、打刻時刻、種別、位置情報（任意）をサーバーに送信。
4. サーバーがデータをデータベースに保存。
5. 利用者に処理結果を通知。

#### エラー処理

- **認証失敗**：エラーメッセージを表示（例：「ログイン情報が正しくありません」）。
- **通信エラー**：オフラインモードで一時保存し、後で同期。
- **時刻異常**：システム時刻が取得できない場合、エラーログを記録し管理者通知。
- **位置情報エラー**：GPS データ取得失敗時、打刻は続行しエラーログを記録。

## データ設計

### データベース構造

#### 打刻履歴テーブル (T_ATTENDANCE_LOG)

| 項目名          | データ型     | 説明                                | 主キー |
| --------------- | ------------ | ----------------------------------- | ------ |
| log_id          | BIGINT       | 打刻ログ ID（自動採番）             | ○      |
| employee_id     | VARCHAR(10)  | 従業員 ID                           |        |
| timestamp       | DATETIME     | 打刻時刻（JST）                     |        |
| attendance_type | VARCHAR(2)   | 打刻種別（出社:01/退社:02）         |        |
| device_type     | VARCHAR(2)   | デバイス種別（アプリ:02/ウェブ:03） |        |
| location        | VARCHAR(100) | 位置情報（GPS 座標、任意）          |        |

## インターフェース設計

### 外部インターフェース

- **スマートフォンアプリ**
  - OS：iOS 15 以上、Android 10 以上
  - API：RESTful API（JSON 形式）
  - 認証：JWT トークンまたは生体認証
- **ウェブインターフェース**
  - 対応ブラウザ：Chrome、Firefox、Safari（最新バージョン）
  - API：RESTful API（JSON 形式）
  - 認証：JWT トークン

### 内部インターフェース

- **サーバー間通信**
  - プロトコル：HTTPS
  - データ形式：JSON
  - エンドポイント例：
    - POST /api/attendance/remote-log（リモート打刻データ登録）

## 非機能要件

### 性能

- 打刻処理：1 秒以内に完了
- 同時打刻：最大 500 人/分

### 可用性

- 稼働率：99.9%
- メンテナンス時間：毎月第 2 日曜 0:00-3:00

### セキュリティ

- データ暗号化：TLS 1.3
- 認証：多要素認証（アプリおよびウェブ）
- ログ監視：不正アクセス検知
- 位置情報：ユーザーの同意に基づく収集、暗号化保存

## テスト計画

### 単体テスト

- 各コンポーネント（アプリ認証、ウェブ認証、データ保存、位置情報取得）の動作確認。

### 結合テスト

- アプリおよびウェブからの打刻データが同一 DB に正しく保存されることを確認。

### 負荷テスト

- 500 人同時打刻時のレスポンスタイムを測定。

## 運用・保守

### 運用体制

- サポート窓口：平日 9:00-17:00
- 障害対応：24 時間 365 日（緊急時）

### 保守内容

- 月次パッチ適用
- 年次システムアップデート

## 付録

### 用語集

- 打刻：出社または退社時刻を記録する行為
- リモートワーク：オフィス外（自宅など）での勤務形態
- アプリ：出退勤管理用スマートフォンアプリケーション
- ウェブインターフェース：ブラウザ経由でアクセスする打刻用ウェブページ

### 参考資料

- 日本 IT 業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025 年 6 月版）
