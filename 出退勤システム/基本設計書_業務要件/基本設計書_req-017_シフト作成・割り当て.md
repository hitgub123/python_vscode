# 基本設計書

## ドキュメント概要

本基本設計書は、出退勤システムの要件に基づき、システムの基本設計を定義するものである。日本 IT 業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要

本システムは、従業員の出退勤時刻を正確に記録・管理するための出退勤システムである。主な機能として、シフト管理機能を提供し、管理職が利用することを想定している。

## 要件定義

### 要件一覧

| ID      | 分類       | 要件名               | 概要                                                                                 | 利用者 |
| ------- | ---------- | -------------------- | ------------------------------------------------------------------------------------ | ------ |
| req-017 | シフト管理 | シフト作成・割り当て | 管理職は、従業員グループまたは個人に対し、柔軟に勤務シフトを作成し、割り当てられる。 | 管理職 |

## 機能設計

### シフト作成・割り当て機能 (req-017)

#### 機能概要

管理職が従業員グループまたは個人に対して、柔軟に勤務シフトを作成し、割り当てる機能を提供する。

#### 入力仕様

- **シフト作成画面**
  - シフト期間：開始日、終了日
  - 対象従業員：従業員 ID、従業員グループ
  - 勤務パターン：勤務時間、休憩時間、勤務場所
  - 特記事項：備考欄
- **シフト割り当て画面**
  - 従業員 ID
  - 割り当てるシフト：作成済みのシフトパターンを選択
  - 開始日
  - 終了日

#### 出力仕様

- **シフト作成画面**
  - 作成完了メッセージ
  - 作成したシフトのプレビュー表示
- **シフト割り当て画面**
  - 割り当て完了メッセージ
  - 割り当てられたシフトの確認画面（対象従業員、期間、勤務パターンなど）

#### 処理フロー

1. 管理職がシフト作成画面または割り当て画面を開く。
2. 必要な情報を入力する。
3. システムが入力された情報を検証する。
4. 検証成功後、シフト情報をデータベースに保存する。
5. 管理職に処理結果を通知する。
6. 必要に応じて、対象従業員にシフト情報を通知する（メール、アプリ通知など）。

#### エラー処理

- **入力値エラー**：必須項目が未入力の場合、または入力形式が誤っている場合、<span style="color:red;">エラーメッセージを表示する</span>（例：「シフト期間が不正です」「対象従業員を選択してください」）。
- **データベースエラー**：データベースへの保存に失敗した場合、<span style="color:red;">エラーログを記録し、管理者に通知する</span>。
- **同時編集エラー**：同じシフト情報を同時に編集しようとした場合、<span style="color:red;">競合エラーメッセージを表示する</span>。

## データ設計

### データベース構造

#### シフトマスタテーブル (T_SHIFT_MASTER)

| 項目名     | データ型     | 説明                  | 主キー |
| ---------- | ------------ | --------------------- | ------ |
| shift_id   | BIGINT       | シフト ID（自動採番） | ○      |
| shift_name | VARCHAR(50)  | シフト名              |        |
| start_time | TIME         | 勤務開始時間          |        |
| end_time   | TIME         | 勤務終了時間          |        |
| break_time | INT          | 休憩時間（分）        |        |
| location   | VARCHAR(100) | 勤務場所              |        |
| created_by | VARCHAR(10)  | 作成者（管理職 ID）   |        |
| created_at | DATETIME     | 作成日時              |        |
| updated_by | VARCHAR(10)  | 更新者（管理職 ID）   |        |
| updated_at | DATETIME     | 更新日時              |        |

#### シフト割り当てテーブル (T_SHIFT_ASSIGNMENT)

| 項目名        | データ型    | 説明                    | 主キー |
| ------------- | ----------- | ----------------------- | ------ |
| assignment_id | BIGINT      | 割り当て ID（自動採番） | ○      |
| employee_id   | VARCHAR(10) | 従業員 ID               |        |
| shift_id      | BIGINT      | シフト ID               |        |
| start_date    | DATE        | 割り当て開始日          |        |
| end_date      | DATE        | 割り当て終了日          |        |
| assigned_by   | VARCHAR(10) | 割り当て者（管理職 ID） |        |
| assigned_at   | DATETIME    | 割り当て日時            |        |

## インターフェース設計

### 内部インターフェース

- **シフト管理画面**
  - 技術：Web ブラウザ
  - プロトコル：HTTPS
  - データ形式：JSON
  - エンドポイント例：
    - POST /api/shift/create（シフト作成）
    - POST /api/shift/assign（シフト割り当て）
    - GET /api/shift/list（シフト一覧取得）

## 非機能要件

### 性能

- シフト作成処理：3 秒以内に完了
- シフト割り当て処理：3 秒以内に完了

### 可用性

- 稼働率：99.9%
- メンテナンス時間：毎月第 2 日曜 0:00-3:00

### セキュリティ

- アクセス制御：ロールベースアクセス制御（RBAC）
- データ暗号化：データベース暗号化

## テスト計画

### 単体テスト

- 各コンポーネント（シフト作成、シフト割り当て、データ保存）の動作確認。

### 結合テスト

- シフト作成とシフト割り当てが連携して正しく動作することを確認。

### ユーザビリティテスト

- 管理職がシフト作成・割り当て機能を容易に利用できることを確認。

## 運用・保守

### 運用体制

- サポート窓口：平日 9:00-17:00
- 障害対応：24 時間 365 日（緊急時）

### 保守内容

- 月次パッチ適用
- 年次システムアップデート

## 付録

### 用語集

- シフト：勤務時間、休憩時間、勤務場所などを定めた勤務パターン
- 勤務パターン：複数のシフトを組み合わせた勤務スケジュール
- 管理職：シフト作成・割り当て権限を持つ従業員

### 参考資料

- 日本 IT 業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025 年 6 月版）
