
# 基本設計書

## ドキュメント概要

本基本設計書は、出退勤システムの要件に基づき、システムの基本設計を定義するものである。日本 IT 業界の標準的な規範に従い、明確かつ構造化された記述を行う。

## システム概要

本システムは、従業員の出退勤時刻を正確に記録・管理するための出退勤システムである。本設計書では、過去の勤怠データを検索・参照する機能について定義する。

## 要件定義

### 要件一覧

| ID      | 分類                       | 要件名                   | 概要                                                                 | 利用者                     |
| ------- | -------------------------- | ------------------------ | -------------------------------------------------------------------- | -------------------------- |
| req-024 | 勤怠データの分析・レポート | 過去勤怠データ検索・参照 | 過去の勤怠データを日付範囲や従業員名、部署などで検索し、参照できる。 | 管理職, 人事部門, 経理部門 |

## 機能設計

### 過去勤怠データ検索・参照機能 (req-024)

#### 機能概要

管理職、人事部門、経理部門の担当者が、Web アプリケーションを通じて、過去の従業員の勤怠データを検索・参照する機能を提供する。

#### 入力仕様

- **Web アプリケーション**
  - **検索条件**:
    - **日付範囲**: 開始日 (YYYY-MM-DD) ～ 終了日 (YYYY-MM-DD) (必須)
    - **従業員名**: テキスト入力（部分一致検索）
    - **従業員 ID**: テキスト入力（完全一致検索）
    - **部署**: 選択式（部署マスタから選択）
    - **雇用形態**: 選択式（正社員、契約社員、アルバイトなど）
  - **表示項目**:
    - 従業員 ID
    - 従業員名
    - 所属部署
    - 出勤日
    - 出勤時刻
    - 退勤時刻
    - 休憩時間
    - 遅刻時間
    - 早退時間
    - 残業時間
    - 勤務時間
    - 備考

#### 出力仕様

- **画面表示**
  - 検索結果は、一覧形式で表示する。
  - 一覧表示件数は、1 ページあたり XX 件とし、ページネーション機能を提供する。
  - 検索結果を CSV 形式でダウンロードできる機能を提供する。

#### 処理フロー

1. 担当者がシステムにログインし、過去勤怠データ検索画面を開く。
2. 担当者が検索条件（日付範囲、従業員名など）を入力し、「検索」ボタンを押下する。
3. システムが、入力された検索条件に基づき、勤怠データテーブルを検索する。
4. 検索結果を、指定された表示項目に従い、一覧形式で画面に表示する。
5. 担当者は、必要に応じて検索結果を CSV 形式でダウンロードする。

#### エラー処理

- **<span style="color:red;">入力不備</span>**: 必須項目が未入力の場合や、日付の前後関係が不正な場合（例：開始日＞終了日）、<span style="color:red;">エラーメッセージを表示し再入力を促す。</span>
- **<span style="color:red;">検索結果なし</span>**: 該当するデータが存在しない場合、<span style="color:red;">「該当するデータが見つかりませんでした。」等のメッセージを表示する。</span>
- **<span style="color:red;">データ件数上限超過</span>**: 検索結果が大量になる場合、<span style="color:red;">「検索結果が XX 件を超えました。検索条件を絞り込んでください。」等のメッセージを表示する。</span>

## データ設計

### データベース構造

#### 勤怠データテーブル (T_ATTENDANCE)

_既存のテーブルを利用することを想定。新規テーブルの作成は不要。既存のテーブル構成は以下を想定。_

| 項目名           | データ型     | 説明                | 主キー |
| ---------------- | ------------ | ------------------- | ------ |
| attendance_id    | BIGINT       | 勤怠 ID（自動採番） | ○      |
| employee_id      | VARCHAR(10)  | 従業員 ID           |        |
| attendance_date  | DATE         | 出勤日              |        |
| clock_in_time    | DATETIME     | 出勤時刻            |        |
| clock_out_time   | DATETIME     | 退勤時刻            |        |
| break_time       | INT          | 休憩時間（分）      |        |
| late_time        | INT          | 遅刻時間（分）      |        |
| early_leave_time | INT          | 早退時間（分）      |        |
| overtime         | INT          | 残業時間（分）      |        |
| remarks          | VARCHAR(255) | 備考                |        |

#### 従業員マスタテーブル (T_EMPLOYEE)

_既存のテーブルを利用することを想定。_

| 項目名          | データ型    | 説明           | 主キー |
| --------------- | ----------- | -------------- | ------ |
| employee_id     | VARCHAR(10) | 従業員 ID      | ○      |
| employee_name   | VARCHAR(50) | 従業員名       |        |
| department_id   | VARCHAR(10) | 部署 ID        |        |
| employment_type | VARCHAR(2)  | 雇用形態コード |        |

#### 部署マスタテーブル (T_DEPARTMENT)

_既存のテーブルを利用することを想定。_

| 項目名          | データ型    | 説明    | 主キー |
| --------------- | ----------- | ------- | ------ |
| department_id   | VARCHAR(10) | 部署 ID | ○      |
| department_name | VARCHAR(50) | 部署名  |        |

## インターフェース設計

### 内部インターフェース

- **サーバー間通信**
  - プロトコル: HTTPS
  - データ形式: JSON
  - エンドポイント例:
    - GET /api/attendances/search （勤怠データ検索）

## 非機能要件

### 性能

- 検索処理: 検索条件に合致するデータが 1000 件の場合、5 秒以内に検索結果を表示すること。
- CSV ダウンロード: 検索結果が 10000 件の場合、10 秒以内に CSV ファイルをダウンロードできること。

### セキュリティ

- 参照権限のある担当者のみが、過去勤怠データを検索・参照できること。
- ダウンロードした CSV ファイルは、適切なアクセス制御を行うこと。

## テスト計画

### 単体テスト

- 検索画面の入力バリデーション（必須項目、日付の妥当性）が正しく機能することを確認する。
- 検索条件に基づき、勤怠データテーブルから正しいデータが抽出されることを確認する。

### 結合テスト

- 従業員マスタ、部署マスタと連携し、正しい従業員名、部署名が表示されることを確認する。
- CSV ダウンロード機能が正しく動作することを確認する。

## 付録

### 用語集

- **勤怠データ**: 従業員の出退勤に関する記録。
- **雇用形態**: 従業員の雇用区分（例：正社員、契約社員、アルバイト）。

### 参考資料

- 日本 IT 業界標準設計書テンプレート（JISA）
- 出退勤システム要件定義書（2025 年 6 月版）

